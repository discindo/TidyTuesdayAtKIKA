---
title: "Tidy Tuesday 43 / 2019"
output: html_notebook
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width = 12, fig.height = 8, fig.path = 'figures3/',
                      echo = TRUE, eval = FALSE, warning = FALSE, message = FALSE)
```


Libraries

```{r}
library(tidyverse)
```


Load the data

```{r}
horror_movies <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-10-22/horror_movies.csv")
```


```{r}
glimpse(horror_movies)
```

# Што треба да се поправи во податоците?
- **release_date** да биде соодветен датум формат а на **<chr>**;
- **movie_run_time** можеби треба да се вика **mins** и да ги има само минутите во колоната;
- **budget** да биде една валута; 

# Идеи за графици?
- Wordcloud за plot?
- Мапа на локации за снимање?
- ...?


# Wordcloud за заплетот на филмовите

```{r}
#install.packages('ggwordcloud')
#install.packages("tidytext")
#there are alternatives: wordcloud and tm 

library(ggwordcloud)
library(tidytext)
```

```{r}
txtplot <- horror_movies %>% 
  select(matches("plot")) %>% 
  unnest_tokens(word, plot) %>% 
  dplyr::count(word, sort = TRUE)
```


Чистење на податоците од т.н. stop words и бројки
```{r}
data("stop_words")
txtplot_clean <- txtplot %>%
  anti_join(stop_words)
```

```{r}
# remove numbers
nums <-  txtplot_clean %>% 
  filter(str_detect(word, "^[0-9]")) %>% 
  select(word) %>% 
  unique()

txtplot_clean <- txtplot_clean %>% 
  anti_join(nums, by = "word")
```


```{r}
# remove unique stop words that snuck in there
uni_sw <- data.frame(word = c("directed","michael","john", "david", "james", "film", "horror"))

txtplot_clean <- txtplot_clean %>% 
  anti_join(uni_sw, by = "word")
```

#Plot the the horro plots
```{r}
words_to_plot <-  top_n(txtplot_clean, 15, wt = n)

img <- png::readPNG("./halloween-pumpkin-xxl.png")

ggplot(words_to_plot) +
  aes(label = word) +
  aes(size = n, color = n) +
  geom_text_wordcloud() + 
  scale_size_area(max_size = 24) +
  theme_void() + 
  scale_color_gradient(low = "darkred", high = "red") +
  ggpubr::background_image(img)

```

